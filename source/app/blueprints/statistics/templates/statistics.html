{% extends "layouts/default.html" %}

{% block title %} Statistics {% endblock title %}

{% block stylesheets %}
	<link rel="stylesheet" href="/static/assets/css/select2.css">
	<style>
		.stats-chart-wrapper {
			min-height: 260px;
			position: relative;
		}

		.stats-chart-wrapper canvas {
			width: 100% !important;
			height: 260px !important;
		}

		.stats-chart-legend {
			max-height: 160px;
			overflow-y: auto;
			font-size: 0.85rem;
			margin-top: 0.75rem;
		}

		.stats-chart-legend ul {
			list-style: none;
			padding-left: 0;
			margin-bottom: 0;
			display: flex;
			flex-wrap: wrap;
			gap: 4px 12px;
		}

		.stats-chart-legend li {
			display: flex;
			align-items: center;
			margin-bottom: 0;
		}

		.stats-chart-legend li span {
			display: inline-block;
			width: 12px;
			height: 12px;
			margin-right: 8px;
			border-radius: 2px;
			flex-shrink: 0;
		}

		.queue-metric-list {
			list-style: none;
			padding-left: 0;
			margin-bottom: 0;
		}

		.queue-metric-list li {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 6px;
			font-size: 0.85rem;
		}

		.queue-metric-label {
			text-transform: uppercase;
			color: #6c757d;
			font-weight: 600;
		}

		.queue-metric-value {
			font-weight: 600;
		}

		.critical-card {
			border-left: 4px solid transparent;
			transition: border-color 0.2s ease;
		}

		.critical-card .critical-value {
			transition: color 0.2s ease;
		}

		.critical-card-ok {
			border-color: #2dce89 !important;
		}

		.critical-card-ok .critical-value {
			color: #2dce89 !important;
		}

		.critical-card-warn {
			border-color: #fdaf4b !important;
		}

		.critical-card-warn .critical-value {
			color: #fdaf4b !important;
		}

		.critical-card-bad {
			border-color: #f3545d !important;
		}

		.critical-card-bad .critical-value {
			color: #f3545d !important;
		}

		.stats-info-icon {
			color: #6c757d;
			cursor: pointer;
			font-size: 0.75rem;
			display: inline-flex;
			align-items: center;
			line-height: 1;
		}

		.stats-info-icon i {
			font-family: "Font Awesome 5 Free", "FontAwesome";
			font-weight: 400;
		}

		.stats-info-icon i::before {
			content: "\f29c";
		}

		.stats-info-icon:hover,
		.stats-info-icon:focus {
			color: #177dff;
			text-decoration: none;
		}

		.stats-link-icon {
			color: #6c757d;
			margin-left: 4px;
			font-size: 0.75rem;
			display: inline-flex;
			align-items: center;
		}

		.stats-link-icon:hover,
		.stats-link-icon:focus {
			color: #177dff;
			text-decoration: none;
		}

		.stats-link-disabled {
			color: #adb5bd !important;
			cursor: default;
			pointer-events: none;
		}
	</style>
{% endblock stylesheets %}

{% block content %}

{{ form.hidden_tag() }}

<div class="page-inner" id="statsPageRoot">
	<div class="row">
		<div class="col-12">
			<div class="card">
				<div class="card-header d-flex justify-content-between align-items-center">
					<div class="card-title mb-0">
						Statistics filters
								<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Adjust timeframe and filters applied to all statistics on this page." aria-label="Statistics filters help">
									<i class="fa fa-question-circle-o"></i>
						</span>
					</div>
					<small class="text-muted" id="statsSummaryRange">--</small>
				</div>
				<div class="card-body">
					<form id="statsFilterForm" autocomplete="off">
						<div class="form-row">
							<div class="form-group col-md-3">
								<label for="statsStart">Start</label>
								<input type="datetime-local" class="form-control" id="statsStart" name="start">
							</div>
							<div class="form-group col-md-3">
								<label for="statsEnd">End</label>
								<input type="datetime-local" class="form-control" id="statsEnd" name="end">
							</div>
							<div class="form-group col-md-2">
								<label for="statsClient">Customer</label>
								<select class="form-control" id="statsClient" name="client_id">
									<option value="">All customers</option>
								</select>
							</div>
							<div class="form-group col-md-2">
								<label for="statsSeverity">Severity</label>
								<select class="form-control" id="statsSeverity" name="severity_id">
									<option value="">All severities</option>
								</select>
							</div>
							<div class="form-group col-md-2">
								<label for="statsCaseStatus">Case status</label>
								<select class="form-control" id="statsCaseStatus" name="case_status_id">
									<option value="">All statuses</option>
								</select>
							</div>
						</div>
						<div class="d-flex flex-wrap align-items-center mt-3">
							<div class="btn-group btn-group-sm mr-3 mb-2" role="group" aria-label="Quick ranges">
								<button type="button" class="btn btn-outline-primary stats-quick-range" data-range-key="last15m" data-minutes="15">Last 15 minutes</button>
								<button type="button" class="btn btn-outline-primary stats-quick-range" data-range-key="last1h" data-hours="1">Last hour</button>
								<button type="button" class="btn btn-outline-primary stats-quick-range" data-range-key="last12h" data-hours="12">Last 12 hours</button>
								<button type="button" class="btn btn-outline-primary stats-quick-range" data-range-key="last7d" data-days="7">Last 7 days</button>
								<button type="button" class="btn btn-outline-primary stats-quick-range" data-range-key="last30d" data-days="30">Last 30 days</button>
								<button type="button" class="btn btn-outline-primary stats-quick-range" data-range-key="last90d" data-days="90">Last 90 days</button>
								<button type="button" class="btn btn-outline-primary stats-quick-range" data-range-key="last6m" data-months="6">Last 6 months</button>
								<button type="button" class="btn btn-outline-primary stats-quick-range" data-range-key="last1y" data-years="1">Last 1 year</button>
								<button type="button" class="btn btn-outline-primary stats-quick-range" data-range-key="last2y" data-years="2">Last 2 years</button>
								<button type="button" class="btn btn-outline-primary stats-quick-range" data-range-key="last5y" data-years="5">Last 5 years</button>
							</div>
							<div class="custom-control custom-switch ml-sm-3 mb-2">
								<input type="checkbox" class="custom-control-input" id="statsAutoRefresh">
								<label class="custom-control-label" for="statsAutoRefresh">Auto-refresh</label>
							</div>
							<div class="ml-sm-auto d-flex align-items-center mb-2">
								<button type="submit" class="btn btn-primary btn-sm mr-2" id="statsApplyBtn">Apply filters</button>
								<button type="button" class="btn btn-secondary btn-sm" id="statsResetBtn">Reset</button>
							</div>
						</div>
					</form>
					<div class="loader1 text-center d-none mt-3" id="statsLoadingIndicator">Loadingâ€¦</div>
				</div>
			</div>
		</div>
	</div>

	<div class="row">
		<div class="col-12">
			<div class="card mb-4" id="queueSection">
				<div class="card-header d-flex justify-content-between align-items-center">
					<div class="card-title mb-0">
						Queue Size
								<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Key indicators for current alert queue health." aria-label="Queue size help">
									<i class="fa fa-question-circle-o"></i>
						</span>
					</div>
					<small class="text-muted" id="queueSummaryRange">--</small>
				</div>
				<div class="card-body">
					<div class="row">
						<div class="col-xl-3 col-lg-6 mb-3">
							<div class="card h-100 critical-card" id="queueUnassignedAlertsCard">
								<div class="card-body">
									<h5 class="card-title text-uppercase text-muted mb-1">
										Unassigned alerts
                                        <a class="stats-link-icon float-right stats-link-disabled" id="queueUnassignedAlertsLink" href="#" target="_blank" rel="noopener noreferrer" title="Open matching alerts" aria-label="Open matching alerts">
											<i class="fa fa-external-link"></i>
										</a>
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Open alerts that currently have no assigned owner." aria-label="Unassigned alerts help">
											<i class="fa fa-question-circle-o"></i>
										</span>
									</h5>
									<span class="display-4 critical-value" id="queueUnassignedAlerts">--</span>
								</div>
							</div>
						</div>
						<div class="col-xl-3 col-lg-6 mb-3">
							<div class="card h-100 critical-card" id="queueNewAlertsTotalCard">
								<div class="card-body">
									<h5 class="card-title text-uppercase text-muted mb-1">
										Alerts created
										<a class="stats-link-icon float-right stats-link-disabled" id="queueNewAlertsTotalLink" href="#" target="_blank" rel="noopener noreferrer" title="Open matching alerts" aria-label="Open matching alerts">
											<i class="fa fa-external-link"></i>
										</a>
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Total alerts generated within the selected timeframe." aria-label="Alerts created help">
											<i class="fa fa-question-circle-o"></i>
										</span>
									</h5>
									<span class="display-4 critical-value" id="queueNewAlertsTotal">--</span>
								</div>
							</div>
						</div>
						<div class="col-xl-3 col-lg-6 mb-3">
							<div class="card h-100 critical-card" id="queueNewAlertsRecentCard">
								<div class="card-body">
									<h5 class="card-title text-uppercase text-muted mb-1">
										New alerts
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Alerts created during the last 2, 24, and 48 hours." aria-label="New alerts windows help">
											<i class="fa fa-question-circle-o"></i>
										</span>
									</h5>
									<ul class="queue-metric-list mb-0">
										<li>
											<span class="queue-metric-label">
												Last 2h
												<a class="stats-link-icon float-right stats-link-disabled" id="queueNewAlerts2hLink" href="#" target="_blank" rel="noopener noreferrer" title="Open matching alerts" aria-label="Open matching alerts">
													<i class="fa fa-external-link"></i>
												</a>
											</span>
											<span class="queue-metric-value" id="queueNewAlerts2h">--</span>
										</li>
										<li>
											<span class="queue-metric-label">
												Last 24h
												<a class="stats-link-icon float-right stats-link-disabled" id="queueNewAlerts24hLink" href="#" target="_blank" rel="noopener noreferrer" title="Open matching alerts" aria-label="Open matching alerts">
													<i class="fa fa-external-link"></i>
												</a>
											</span>
											<span class="queue-metric-value" id="queueNewAlerts24h">--</span>
										</li>
										<li>
											<span class="queue-metric-label">
												Last 48h
												<a class="stats-link-icon float-right stats-link-disabled" id="queueNewAlerts48hLink" href="#" target="_blank" rel="noopener noreferrer" title="Open matching alerts" aria-label="Open matching alerts">
													<i class="fa fa-external-link"></i>
												</a>
											</span>
											<span class="queue-metric-value" id="queueNewAlerts48h">--</span>
										</li>
									</ul>
								</div>
							</div>
						</div>
						<div class="col-xl-3 col-lg-6 mb-3">
							<div class="card h-100 critical-card" id="queueNewUnassignedRecentCard">
								<div class="card-body">
									<h5 class="card-title text-uppercase text-muted mb-1">
										Unassigned alerts
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Alerts without an owner created during the last 2, 24, and 48 hours." aria-label="Recent unassigned alerts help">
											<i class="fa fa-question-circle-o"></i>
										</span>
									</h5>
									<ul class="queue-metric-list mb-0">
										<li>
											<span class="queue-metric-label">
												Last 2h
												<a class="stats-link-icon float-right stats-link-disabled" id="queueNewUnassigned2hLink" href="#" target="_blank" rel="noopener noreferrer" title="Open matching alerts" aria-label="Open matching alerts">
													<i class="fa fa-external-link"></i>
												</a>
											</span>
											<span class="queue-metric-value" id="queueNewUnassigned2h">--</span>
										</li>
										<li>
											<span class="queue-metric-label">
												Last 24h
												<a class="stats-link-icon float-right stats-link-disabled" id="queueNewUnassigned24hLink" href="#" target="_blank" rel="noopener noreferrer" title="Open matching alerts" aria-label="Open matching alerts">
													<i class="fa fa-external-link"></i>
												</a>
											</span>
											<span class="queue-metric-value" id="queueNewUnassigned24h">--</span>
										</li>
										<li>
											<span class="queue-metric-label">
												Last 48h
												<a class="stats-link-icon float-right stats-link-disabled" id="queueNewUnassigned48hLink" href="#" target="_blank" rel="noopener noreferrer" title="Open matching alerts" aria-label="Open matching alerts">
													<i class="fa fa-external-link"></i>
												</a>
											</span>
											<span class="queue-metric-value" id="queueNewUnassigned48h">--</span>
										</li>
									</ul>
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-xl-6 col-lg-6 mb-3">
							<div class="card h-100 critical-card" id="queueResolutionUnknownCard">
								<div class="card-body">
									<h5 class="card-title text-uppercase text-muted mb-1">
										Resolution unknown/unset
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Alerts whose resolution status is missing or marked as unknown." aria-label="Resolution unknown help">
											<i class="fa fa-question-circle"></i>
										</span>
									</h5>
									<span class="display-4 critical-value" id="queueResolutionUnknownCount">--</span>
									<p class="text-muted mb-0"><small id="queueResolutionUnknownRatio">N/A</small></p>
								</div>
							</div>
						</div>
						<div class="col-xl-6 col-lg-6 mb-3">
							<div class="card h-100 critical-card" id="queueStatusNewCard">
								<div class="card-body">
									<h5 class="card-title text-uppercase text-muted mb-1">
										Status new
										<a class="stats-link-icon float-right stats-link-disabled" id="queueStatusNewLink" href="#" target="_blank" rel="noopener noreferrer" title="Open matching alerts" aria-label="Open matching alerts">
											<i class="fa fa-external-link"></i>
										</a>
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Alerts that remain in the initial 'New' status." aria-label="Status new help">
											<i class="fa fa-question-circle"></i>
										</span>
									</h5>
									<span class="display-4 critical-value" id="queueStatusNewCount">--</span>
									<p class="text-muted mb-0"><small id="queueStatusNewRatio">N/A</small></p>
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-12">
							<div class="card h-100">
								<div class="card-header d-flex justify-content-between align-items-center">
									<div class="card-title mb-0">
										Alert over time
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Timeline of alert creation counts for the selected window." aria-label="Alert over time help">
											<i class="fa fa-question-circle"></i>
										</span>
									</div>
								</div>
								<div class="card-body">
									<div id="queueAlertStatusEmpty" class="text-center text-muted">No data available</div>
									<div class="stats-chart-wrapper" style="min-height:260px;">
										<canvas id="queueAlertStatusChart" class="d-none"></canvas>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-xl-6 col-lg-6 mb-3 d-none" id="queueHighPriorityCol">
					<div class="card h-100 critical-card critical-card-bad" id="queueHighPriorityCard">
						<div class="card-body">
							<h5 class="card-title text-uppercase text-muted mb-1">
								High priority unattended
								<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Critical and high severity alerts lacking ownership or still New." aria-label="High priority alerts help">
									<i class="fa fa-question-circle"></i>
								</span>
							</h5>
							<p class="text-muted mb-2"><small>Counts of critical/high alerts without an owner or remaining in status New.</small></p>
							<ul class="queue-metric-list mb-0">
								<li><span class="queue-metric-label">Last 2h</span><span class="queue-metric-value" id="queueHighPriority2h">--</span></li>
								<li><span class="queue-metric-label">Last 24h</span><span class="queue-metric-value" id="queueHighPriority24h">--</span></li>
							</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="row">
		<div class="col-12">
			<div class="card mb-4" id="alertsSection">
				<div class="card-header d-flex justify-content-between align-items-center">
					<div class="card-title mb-0">
						Alerts
						<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Performance indicators and distributions for alert handling." aria-label="Alerts section help">
							<i class="fa fa-question-circle"></i>
						</span>
					</div>
					<small class="text-muted" id="alertsSummaryTotal">--</small>
				</div>
				<div class="card-body">
					<div class="row">
						<div class="col-xl-6 col-lg-6 mb-3">
							<div class="card h-100">
								<div class="card-body">
									<h5 class="card-title text-uppercase text-muted mb-1">
										Mean time to detect
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Average duration between source event time and alert creation." aria-label="Mean time to detect help">
											<i class="fa fa-question-circle"></i>
										</span>
									</h5>
									<span class="h2 font-weight-bold" id="alertsMttdPrimary">--</span>
									<p class="text-muted mb-0"><small id="alertsMttdSecondary">--</small></p>
								</div>
							</div>
						</div>
						<div class="col-xl-6 col-lg-6 mb-3">
							<div class="card h-100">
								<div class="card-body">
									<h5 class="card-title text-uppercase text-muted mb-1">
										Mean Time To Respond
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Average time from alert creation to the second recorded history entry." aria-label="Alert MTTR help">
											<i class="fa fa-question-circle"></i>
										</span>
									</h5>
									<span class="h2 font-weight-bold" id="alertsMttrPrimary">--</span>
									<p class="text-muted mb-0"><small id="alertsMttrSecondary">--</small></p>
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-xl-4 col-lg-6 mb-3">
							<div class="card h-100">
								<div class="card-body">
									<h5 class="card-title text-uppercase text-muted mb-1">
										Detection coverage
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Percentage of alerts linked to at least one case." aria-label="Detection coverage help">
											<i class="fa fa-question-circle"></i>
										</span>
									</h5>
									<span class="h2" id="alertsDetectionCoverage">--</span>
								</div>
							</div>
						</div>
						<div class="col-xl-4 col-lg-6 mb-3">
							<div class="card h-100">
								<div class="card-body">
									<h5 class="card-title text-uppercase text-muted mb-1">
										Escalation rate
										<a class="stats-link-icon float-right stats-link-disabled" id="alertsEscalationRateLink" href="#" target="_blank" rel="noopener noreferrer" title="Open matching alerts" aria-label="Open matching alerts">
											<i class="fa fa-external-link"></i>
										</a>
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Percentage of alerts marked with an escalated status." aria-label="Escalation rate help">
											<i class="fa fa-question-circle"></i>
										</span>
									</h5>
									<span class="h2" id="alertsEscalationRate">--</span>
								</div>
							</div>
						</div>
						<div class="col-xl-4 col-lg-6 mb-3">
							<div class="card h-100">
								<div class="card-body">
									<h5 class="card-title text-uppercase text-muted mb-1">
										False positive rate
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Percentage of alerts tagged as false positives." aria-label="False positive rate help">
											<i class="fa fa-question-circle"></i>
										</span>
									</h5>
									<span class="h2" id="alertsFalsePositiveRate">--</span>
								</div>
							</div>
						</div>
					</div>

					<div class="row">
						<div class="col-lg-4 col-md-6 mb-3">
							<div class="card h-100">
								<div class="card-body">
									<h5 class="card-title text-uppercase text-muted mb-1">
										Total alerts
										<a class="stats-link-icon float-right stats-link-disabled" id="alertsTotalLink" href="#" target="_blank" rel="noopener noreferrer" title="Open matching alerts" aria-label="Open matching alerts">
											<i class="fa fa-external-link"></i>
										</a>
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Count of alerts created during the selected timeframe." aria-label="Total alerts help">
											<i class="fa fa-question-circle"></i>
										</span>
									</h5>
									<span class="display-4" id="alertsTotal">--</span>
								</div>
							</div>
						</div>
						<div class="col-lg-4 col-md-6 mb-3">
							<div class="card h-100">
								<div class="card-body">
									<h5 class="card-title text-uppercase text-muted mb-1">
										False positives
										<a class="stats-link-icon float-right stats-link-disabled" id="alertsFalsePositiveLink" href="#" target="_blank" rel="noopener noreferrer" title="Open matching alerts" aria-label="Open matching alerts">
											<i class="fa fa-external-link"></i>
										</a>
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Number of alerts resolved as false positive." aria-label="False positives count help">
											<i class="fa fa-question-circle"></i>
										</span>
									</h5>
									<span class="display-4" id="alertsFalsePositive">--</span>
								</div>
							</div>
						</div>
						<div class="col-lg-4 col-md-6 mb-3">
							<div class="card h-100">
								<div class="card-body">
									<h5 class="card-title text-uppercase text-muted mb-1">
										Linked to cases
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Alerts associated with at least one case record." aria-label="Linked to cases help">
											<i class="fa fa-question-circle"></i>
										</span>
									</h5>
									<span class="display-4" id="alertsAssociated">--</span>
								</div>
							</div>
						</div>
					</div>

					<div class="row">
						<div class="col-xl-4 col-lg-6 mb-3">
							<div class="card h-100">
								<div class="card-header d-flex justify-content-between align-items-center">
									<div class="card-title mb-0">
										Alert severity
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Distribution of alerts by severity classification." aria-label="Alert severity help">
											<i class="fa fa-question-circle"></i>
										</span>
									</div>
									<small class="text-muted" id="alertsSeverityTotal">--</small>
								</div>
								<div class="card-body">
									<div id="alertsSeverityEmpty" class="text-center text-muted">No data available</div>
									<div class="stats-chart-wrapper" style="min-height:260px;">
										<canvas id="alertsSeverityChart" class="d-none"></canvas>
									</div>
								</div>
							</div>
						</div>
						<div class="col-xl-4 col-lg-6 mb-3">
							<div class="card h-100">
								<div class="card-header d-flex justify-content-between align-items-center">
									<div class="card-title mb-0">
										Alert status
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Distribution of alerts across workflow statuses." aria-label="Alert status help">
											<i class="fa fa-question-circle"></i>
										</span>
									</div>
									<small class="text-muted" id="alertsStatusTotal">--</small>
								</div>
								<div class="card-body">
									<div id="alertsStatusEmpty" class="text-center text-muted">No data available</div>
									<div class="stats-chart-wrapper" style="min-height:260px;">
										<canvas id="alertsStatusChart" class="d-none"></canvas>
									</div>
								</div>
							</div>
						</div>
						<div class="col-xl-4 col-lg-6 mb-3">
							<div class="card h-100">
								<div class="card-header d-flex justify-content-between align-items-center">
									<div class="card-title mb-0">
										Alert resolution status
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Breakdown of how alerts have been resolved." aria-label="Alert resolution help">
											<i class="fa fa-question-circle"></i>
										</span>
									</div>
									<small class="text-muted" id="alertsResolutionTotal">--</small>
								</div>
								<div class="card-body">
									<div id="alertsResolutionEmpty" class="text-center text-muted">No data available</div>
									<div class="stats-chart-wrapper" style="min-height:260px;">
										<canvas id="alertsResolutionChart" class="d-none"></canvas>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="row">
		<div class="col-12">
			<div class="card" id="casesSection">
				<div class="card-header d-flex justify-content-between align-items-center">
					<div class="card-title mb-0">
						Cases
						<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Response metrics and distributions for cases opened in the timeframe." aria-label="Cases section help">
							<i class="fa fa-question-circle"></i>
						</span>
					</div>
					<small class="text-muted" id="casesSummaryTotal">--</small>
				</div>
				<div class="card-body">
					<div class="row">
						<div class="col-lg-6 col-md-6 mb-3">
							<div class="card h-100">
								<div class="card-body">
									<h5 class="card-title text-uppercase text-muted mb-1">
										Mean time to respond
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Average time from case creation to case closure." aria-label="Case MTTR help">
											<i class="fa fa-question-circle"></i>
										</span>
									</h5>
									<span class="h2 font-weight-bold" id="casesMttrPrimary">--</span>
									<p class="text-muted mb-0"><small id="casesMttrSecondary">--</small></p>
								</div>
							</div>
						</div>
						<div class="col-lg-6 col-md-6 mb-3">
							<div class="card h-100">
								<div class="card-body">
									<h5 class="card-title text-uppercase text-muted mb-1">
										Cases resolved
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Number of cases closed during the timeframe." aria-label="Cases resolved help">
											<i class="fa fa-question-circle"></i>
										</span>
									</h5>
									<span class="h2 font-weight-bold" id="casesIncidentsResolved">--</span>
								</div>
							</div>
						</div>
					</div>

					<div class="row">
						<div class="col-lg-4 col-md-6 mb-3">
							<div class="card h-100">
								<div class="card-body">
									<h5 class="card-title text-uppercase text-muted mb-1">
										Cases opened
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Number of cases initiated during the timeframe." aria-label="Cases opened help">
											<i class="fa fa-question-circle"></i>
										</span>
									</h5>
									<span class="display-4" id="casesIncidentsDetected">--</span>
								</div>
							</div>
						</div>
						<div class="col-lg-4 col-md-6 mb-3">
							<div class="card h-100">
								<div class="card-body">
									<h5 class="card-title text-uppercase text-muted mb-1">
										False positive cases
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Cases resolved with a false-positive classification." aria-label="False positive cases help">
											<i class="fa fa-question-circle"></i>
										</span>
									</h5>
									<span class="display-4" id="casesFalsePositives">--</span>
								</div>
							</div>
						</div>
						<div class="col-lg-4 col-md-6 mb-3">
							<div class="card h-100">
								<div class="card-body">
									<h5 class="card-title text-uppercase text-muted mb-1">
										False positive rate
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Percentage of detected cases resolved as false positives." aria-label="Case false positive rate help">
											<i class="fa fa-question-circle"></i>
										</span>
									</h5>
									<span class="h2" id="casesFalsePositiveRate">--</span>
								</div>
							</div>
						</div>
					</div>

					<div class="row">
						<div class="col-lg-6 mb-3">
							<div class="card h-100">
								<div class="card-header d-flex justify-content-between align-items-center">
									<div class="card-title mb-0">
										Case classification
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Distribution of detected cases by classification." aria-label="Case classification help">
											<i class="fa fa-question-circle"></i>
										</span>
									</div>
									<small class="text-muted" id="casesClassificationTotal">--</small>
								</div>
								<div class="card-body">
									<div id="casesClassificationEmpty" class="text-center text-muted">No data available</div>
									<div class="stats-chart-wrapper" style="min-height:260px;">
										<canvas id="casesClassificationChart" class="d-none"></canvas>
									</div>
									<div id="casesClassificationLegend" class="stats-chart-legend d-none"></div>
								</div>
							</div>
						</div>
						<div class="col-lg-6 mb-3">
							<div class="card h-100">
								<div class="card-header d-flex justify-content-between align-items-center">
									<div class="card-title mb-0">
										Case status
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Distribution of detected cases by current status." aria-label="Case status help">
											<i class="fa fa-question-circle"></i>
										</span>
									</div>
									<small class="text-muted" id="casesStatusTotal">--</small>
								</div>
								<div class="card-body">
									<div id="casesStatusEmpty" class="text-center text-muted">No data available</div>
									<div class="stats-chart-wrapper" style="min-height:260px;">
										<canvas id="casesStatusChart" class="d-none"></canvas>
									</div>
								</div>
							</div>
						</div>
					</div>

					<div class="row">
						<div class="col-lg-6 mb-3">
							<div class="card h-100">
								<div class="card-header d-flex justify-content-between align-items-center">
									<div class="card-title mb-0">
										Case severity
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Distribution of detected cases by severity rating." aria-label="Case severity help">
											<i class="fa fa-question-circle"></i>
										</span>
									</div>
									<small class="text-muted" id="casesSeverityTotal">--</small>
								</div>
								<div class="card-body">
									<div id="casesSeverityEmpty" class="text-center text-muted">No data available</div>
									<div class="stats-chart-wrapper" style="min-height:260px;">
										<canvas id="casesSeverityChart" class="d-none"></canvas>
									</div>
								</div>
							</div>
						</div>
						<div class="col-lg-6 mb-3">
							<div class="card h-100">
								<div class="card-header d-flex justify-content-between align-items-center">
									<div class="card-title mb-0">
										Evidence types
										<span class="stats-info-icon float-right" role="button" tabindex="0" data-toggle="tooltip" data-placement="top" title="Distribution of uploaded evidence by type and volume." aria-label="Evidence types help">
											<i class="fa fa-question-circle"></i>
										</span>
									</div>
									<small class="text-muted" id="casesEvidenceSummary">--</small>
								</div>
								<div class="card-body">
									<div id="casesEvidenceEmpty" class="text-center text-muted">No data available</div>
									<div class="stats-chart-wrapper" style="min-height:260px;">
										<canvas id="casesEvidenceChart" class="d-none"></canvas>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

{% endblock content %}

{% block javascripts %}
	<script src="/static/assets/js/plugin/select/select2.js"></script>
	<script src="/static/assets/js/core/moments.min.js"></script>
	<script src="/static/assets/js/core/charts.js"></script>
	<script src="/static/assets/js/iris/statistics.js"></script>
{% endblock javascripts %}
